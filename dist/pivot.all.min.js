(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=[].slice,p=function(a,b){return function(){return a.apply(b,arguments)}},q={}.hasOwnProperty;a=jQuery,c=function(a,b,c){var d,e,f,g;for(a+="",e=a.split("."),f=e[0],g=e.length>1?c+e[1]:"",d=/(\d+)(\d{3})/;d.test(f);)f=f.replace(d,"$1"+b+"$2");return f+g},l=function(b){var d;return d={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:!1},b=a.extend(d,b),function(a){var d;return isNaN(a)||!isFinite(a)?"":0!==a||b.showZero?(d=c((b.scaler*a).toFixed(b.digitsAfterDecimal),b.thousandsSep,b.decimalSep),""+b.prefix+d+b.suffix):""}},h={"default":function(a){return a},percentFormat:l({digitsAfterDecimal:1,scaler:100,suffix:"%"})},d={fractionOf:function(a,b,c,d){return null==b&&(b="Fraction Of"),null==c&&(c="total"),null==d&&(d=h.percentFormat),function(){var e;return e=1<=arguments.length?o.call(arguments,0):[],function(f,g,h){return{name:b,selector:{total:[[],[]],row:[g,[]],col:[[],h]}[c],inner:a.apply(null,e)(f,g,h),push:function(a){return this.inner.push(a)},format:d,value:function(){return this.inner.value()/f.getAggregator.apply(f,this.selector).getWrappedAggregator(b).inner.value()},numInputs:a.apply(null,e)().numInputs}}}}},e={},m={},i={en:{aggregators:e,renderers:m,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter results",totals:"Totals",vs:"vs",by:"by"}}},j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=function(a){return("0"+a).substr(-2,2)},g={bin:function(a,b){return function(c){return c[a]-c[a]%b}},dateFormat:function(a,b,c,d){return null==c&&(c=j),null==d&&(d=f),function(e){var f;return f=new Date(Date.parse(e[a])),isNaN(f)?"":b.replace(/%(.)/g,function(a,b){switch(b){case"y":return f.getFullYear();case"m":return n(f.getMonth()+1);case"n":return c[f.getMonth()];case"d":return n(f.getDate());case"w":return d[f.getDay()];case"x":return f.getDay();case"H":return n(f.getHours());case"M":return n(f.getMinutes());case"S":return n(f.getSeconds());default:return"%"+b}})}}},k=function(a,b){var c,d,e,f,g,h,i;if(h=/(\d+)|(\D+)/g,g=/\d/,i=/^0/,"number"==typeof a||"number"==typeof b)return isNaN(a)?1:isNaN(b)?-1:a-b;if(c=String(a).toLowerCase(),e=String(b).toLowerCase(),c===e)return 0;if(!g.test(c)||!g.test(e))return c>e?1:-1;for(c=c.match(h),e=e.match(h);c.length&&e.length;)if(d=c.shift(),f=e.shift(),d!==f)return g.test(d)&&g.test(f)?d.replace(i,".0")-f.replace(i,".0"):d>f?1:-1;return c.length-e.length},b=function(){function b(a,c){this.getAggregator=p(this.getAggregator,this),this.getRowKeys=p(this.getRowKeys,this),this.getColKeys=p(this.getColKeys,this),this.sortKeys=p(this.sortKeys,this),this.arrSort=p(this.arrSort,this),this.aggregators=c.aggregators,this.aggregatorName=c.aggregatorName,this.colAttrs=c.cols,this.rowAttrs=c.rows,this.valAttrs=c.vals,this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.wrapAggregator(this,[],[]),this.sorted=!1,b.forEachRecord(a,c.derivedAttributes,function(a){return function(b){return c.filter(b)?a.processRecord(b):void 0}}(this))}return b.forEachRecord=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(e=a.isEmptyObject(c)?d:function(a){var b,e,f;for(b in c)e=c[b],a[b]=null!=(f=e(a))?f:a[b];return d(a)},a.isFunction(b))return b(e);if(a.isArray(b)){if(a.isArray(b[0])){o=[];for(g in b)if(q.call(b,g)&&(f=b[g],g>0)){j={},n=b[0];for(h in n)q.call(n,h)&&(i=n[h],j[i]=f[h]);o.push(e(j))}return o}for(p=[],l=0,m=b.length;m>l;l++)j=b[l],p.push(e(j));return p}if(b instanceof jQuery)return k=[],a("thead > tr > th",b).each(function(){return k.push(a(this).text())}),a("tbody > tr",b).each(function(){return j={},a("td",this).each(function(b){return j[k[b]]=a(this).text()}),e(j)});throw new Error("unknown input format")},b.convertToArray=function(a){var c;return c=[],b.forEachRecord(a,{},function(a){return c.push(a)}),c},b.prototype.natSort=function(a,b){return k(a,b)},b.prototype.arrSort=function(a,b){return this.natSort(a.join(),b.join())},b.prototype.sortKeys=function(){return this.sorted||(this.rowKeys.sort(this.arrSort),this.colKeys.sort(this.arrSort)),this.sorted=!0},b.prototype.getColKeys=function(){return this.sortKeys(),this.colKeys},b.prototype.getRowKeys=function(){return this.sortKeys(),this.rowKeys},b.prototype.processRecord=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(b=[],e=[],k=this.colAttrs,g=0,i=k.length;i>g;g++)f=k[g],b.push(null!=(l=a[f])?l:"null");for(m=this.rowAttrs,h=0,j=m.length;j>h;h++)f=m[h],e.push(null!=(n=a[f])?n:"null");return d=e.join(String.fromCharCode(0)),c=b.join(String.fromCharCode(0)),this.allTotal.push(a),0!==e.length&&(this.rowTotals[d]||(this.rowKeys.push(e),this.rowTotals[d]=this.wrapAggregator(this,e,[])),this.rowTotals[d].push(a)),0!==b.length&&(this.colTotals[c]||(this.colKeys.push(b),this.colTotals[c]=this.wrapAggregator(this,[],b)),this.colTotals[c].push(a)),0!==b.length&&0!==e.length?(this.tree[d]||(this.tree[d]={}),this.tree[d][c]||(this.tree[d][c]=this.wrapAggregator(this,e,b)),this.tree[d][c].push(a)):void 0},b.prototype.getAggregator=function(a,b){var c,d,e;return e=a.join(String.fromCharCode(0)),d=b.join(String.fromCharCode(0)),c=0===a.length&&0===b.length?this.allTotal:0===a.length?this.colTotals[d]:0===b.length?this.rowTotals[e]:this.tree[e][d],null!=c?c:{value:function(){return null},format:function(){return""}}},b.prototype.wrapAggregator=function(a,b,c){var d,e;return null==b&&(b=[]),null==c&&(c=[]),e=[],d={},this.aggregators.forEach(function(f,g){var h;return h=f(a,b,c),null!=h.name&&(d[h.name]=g),e.push(h)}),{wrappedAggregators:e,aggregatorMap:d,value:function(){return this.wrappedAggregators.map(function(a){return a.value()})},format:function(a){return null==a&&(a=[]),a.map(function(a){return function(b,c){return a.wrappedAggregators[c].format(b)}}(this))},push:function(a){return this.wrappedAggregators.forEach(function(b){return b.push(a)})},getWrappedAggregator:function(a){return this.wrappedAggregators[this.aggregatorMap[a]]}}},b}(),a.fn.pivot=function(c,d){var e,f,g,h,j;e={cols:[],rows:[],filter:function(){return!0},aggregators:[],aggregatorName:"",derivedAttributes:{},renderer:"",rendererOptions:null,localeStrings:i.en.localeStrings},d=a.extend(e,d),h=null;try{g=new b(c,d);try{h=d.renderer.render(g,d.rendererOptions)}catch(k){f=k,"undefined"!=typeof console&&null!==console&&console.error(f.stack),h=a("<span>").html(d.localeStrings.renderError)}}catch(k){f=k,"undefined"!=typeof console&&null!==console&&console.error(f.stack),h=a("<span>").html(d.localeStrings.computeError)}for(j=this[0];j.hasChildNodes();)j.removeChild(j.lastChild);return this.append(h)},a.pivotUtilities={aggregatorTemplates:d,aggregators:e,renderers:m,derivers:g,locales:i,naturalSort:k,numberFormat:l,formatterTemplates:h,PivotData:b}}).call(this),function(){var a,b={}.hasOwnProperty,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=jQuery,a.fn.pivotUI=function(d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V;null==f&&(f=!1),null==g&&(g="en"),o={derivedAttributes:{},aggregators:a.pivotUtilities.locales[g].aggregators,renderers:a.pivotUtilities.locales[g].renderers,attributes:[],values:[],hiddenAttributes:[],menuLimit:200,cols:[],rows:[],vals:[],exclusions:{},unusedAttrsVertical:"auto",autoSortUnusedAttrs:!1,rendererOptions:{localeStrings:a.pivotUtilities.locales[g].localeStrings},onRefresh:null,filter:function(){return!0},localeStrings:a.pivotUtilities.locales[g].localeStrings},q=this.data("pivotUIOptions"),u=null==q||f?a.extend(o,e):q;try{d=a.pivotUtilities.PivotData.convertToArray(d),C=function(){var a,c;a=d[0],c=[];for(t in a)b.call(a,t)&&c.push(t);return c}(),R=u.derivedAttributes;for(l in R)b.call(R,l)&&c.call(C,l)<0&&C.push(l);for(k={},J=0,N=C.length;N>J;J++)H=C[J],k[H]={};a.pivotUtilities.PivotData.forEachRecord(d,u.derivedAttributes,function(a){var c,d,e;e=[];for(t in a)b.call(a,t)&&(c=a[t],u.filter(a)&&(null==c&&(c="null"),null==(d=k[t])[c]&&(d[c]=0),e.push(k[t][c]++)));return e}),F=a("<table cellpadding='5'>"),z=a("<td>"),y=a("<select class='pvtRenderer'>").appendTo(z).bind("change",function(){return w()}),S=u.renderers;for(H in S)b.call(S,H)&&a("<option>").val(H).html(H).appendTo(y);if(m=a("<td class='pvtAxisContainer pvtUnused'>"),A=u.attributes.length>0?function(){var a,b,d;for(d=[],a=0,b=C.length;b>a;a++)l=C[a],c.call(u.attributes,l)>=0&&d.push(l);return d}():function(){var a,b,d;for(d=[],a=0,b=C.length;b>a;a++)l=C[a],c.call(u.hiddenAttributes,l)<0&&c.call(u.values,l)<0&&d.push(l);return d}(),B=u.values.length>0?function(){var a,b,d;for(d=[],a=0,b=C.length;b>a;a++)n=C[a],c.call(u.values,n)>=0&&d.push(n);return d}():A,G=!1,"auto"===u.unusedAttrsVertical){for(j=0,K=0,O=A.length;O>K;K++)h=A[K],j+=h.length;G=j>120}m.addClass(u.unusedAttrsVertical===!0||G?"pvtVertList":"pvtHorizList"),I=function(b){var d,e,f,g,h,i,j,l,n,o,p,q,s,v,x;if(j=function(){var a;a=[];for(t in k[b])a.push(t);return a}(),i=!1,q=a("<div>").addClass("pvtFilterBox").hide(),q.append(a("<h4>").text(""+b+" ("+j.length+")")),j.length>u.menuLimit)q.append(a("<p>").html(u.localeStrings.tooMany));else for(e=a("<p>").appendTo(q),e.append(a("<button>").html(u.localeStrings.selectAll).bind("click",function(){return q.find("input").prop("checked",!0)})),e.append(a("<button>").html(u.localeStrings.selectNone).bind("click",function(){return q.find("input").prop("checked",!1)})),e.append(a("<input>").addClass("pvtSearch")).attr("placeholder",u.localeStrings.filterResults).bind("keyup",function(){var b;return b=a(this).val().toLowerCase(),a(this).parents(".pvtFilterBox").find("label span").each(function(){var c;return c=this.innerText.toLowerCase().indexOf(b),-1!==c?a(this).parent().show():a(this).parent().hide()})}),f=a("<div>").addClass("pvtCheckContainer").appendTo(q),x=j.sort(a.pivotUtilities.naturalSort),s=0,v=x.length;v>s;s++)t=x[s],p=k[b][t],g=a("<label>"),h=u.exclusions[b]?c.call(u.exclusions[b],t)>=0:!1,i||(i=h),a("<input type='checkbox' class='pvtFilter'>").attr("checked",!h).data("filter",[b,t]).appendTo(g),g.append(a("<span>").text(""+t+" ("+p+")")),f.append(a("<p>").append(g));return o=function(){var b;return b=a(q).find("[type='checkbox']").length-a(q).find("[type='checkbox']:checked").length,b>0?d.addClass("pvtFilteredAttribute"):d.removeClass("pvtFilteredAttribute"),j.length>u.menuLimit?q.toggle():q.toggle(0,w)},a("<p>").appendTo(q).append(a("<button>").text("OK").bind("click",o)),l=function(b){return q.css({left:b.pageX,top:b.pageY}).toggle(),a(".pvtSearch").val(""),a("label").show()},n=a("<span class='pvtTriangle'>").html(" &#x25BE;").bind("click",l),d=a("<li class='axis_"+r+"'>").append(a("<span class='pvtAttr'>").text(b).data("attrName",b).append(n)),i&&d.addClass("pvtFilteredAttribute"),m.append(d).append(q),d.bind("dblclick",l)};for(r in A)l=A[r],I(l);D=a("<tr>").appendTo(F),i=a("<select class='pvtAggregator'>").bind("change",function(){return w()}),T=u.aggregators;for(H in T)b.call(T,H)&&i.append(a("<option>").val(H).html(H));for(a("<td class='pvtVals'>").appendTo(D).append(i).append(a("<br>")),a("<td class='pvtAxisContainer pvtHorizList pvtCols'>").appendTo(D),E=a("<tr>").appendTo(F),E.append(a("<td valign='top' class='pvtAxisContainer pvtRows'>")),v=a("<td valign='top' class='pvtRendererArea'>").appendTo(E),u.unusedAttrsVertical===!0||G?(F.find("tr:nth-child(1)").prepend(z),F.find("tr:nth-child(2)").prepend(m)):F.prepend(a("<tr>").append(z).append(m)),this.html(F),U=u.cols,L=0,P=U.length;P>L;L++)H=U[L],this.find(".pvtCols").append(this.find(".axis_"+A.indexOf(H)));for(V=u.rows,M=0,Q=V.length;Q>M;M++)H=V[M],this.find(".pvtRows").append(this.find(".axis_"+A.indexOf(H)));null!=u.aggregatorName&&this.find(".pvtAggregator").val(u.aggregatorName),null!=u.rendererName&&this.find(".pvtRenderer").val(u.rendererName),s=!0,x=function(b){return function(){var e,f,g,h,j,k,l,m,n,o,p,q,x,z;if(m={derivedAttributes:u.derivedAttributes,localeStrings:u.localeStrings,rendererOptions:u.rendererOptions,cols:[],rows:[]},j=null!=(z=u.aggregators[i.val()]([])().numInputs)?z:0,o=[],b.find(".pvtRows li span.pvtAttr").each(function(){return m.rows.push(a(this).data("attrName"))}),b.find(".pvtCols li span.pvtAttr").each(function(){return m.cols.push(a(this).data("attrName"))}),b.find(".pvtVals select.pvtAttrDropdown").each(function(){return 0===j?a(this).remove():(j--,""!==a(this).val()?o.push(a(this).val()):void 0)}),0!==j)for(l=b.find(".pvtVals"),H=q=0;j>=0?j>q:q>j;H=j>=0?++q:--q){for(h=a("<select class='pvtAttrDropdown'>").append(a("<option>")).bind("change",function(){return w()}),x=0,p=B.length;p>x;x++)e=B[x],h.append(a("<option>").val(e).text(e));l.append(h)}return s&&(o=u.vals,r=0,b.find(".pvtVals select.pvtAttrDropdown").each(function(){return a(this).val(o[r]),r++}),s=!1),m.aggregatorName=i.val(),m.vals=o,m.aggregators=[u.aggregators[i.val()](o)],m.renderer=u.renderers[y.val()],f={},b.find("input.pvtFilter").not(":checked").each(function(){var b;return b=a(this).data("filter"),null!=f[b[0]]?f[b[0]].push(b[1]):f[b[0]]=[b[1]]}),m.filter=function(a){var b,d;if(!u.filter(a))return!1;for(t in f)if(b=f[t],d=""+a[t],c.call(b,d)>=0)return!1;return!0},v.pivot(d,m),k=a.extend(u,{cols:m.cols,rows:m.rows,vals:o,exclusions:f,aggregatorName:i.val(),rendererName:y.val()}),b.data("pivotUIOptions",k),u.autoSortUnusedAttrs&&(g=a.pivotUtilities.naturalSort,n=b.find("td.pvtUnused.pvtAxisContainer"),a(n).children("li").sort(function(b,c){return g(a(b).text(),a(c).text())}).appendTo(n)),v.css("opacity",1),null!=u.onRefresh?u.onRefresh(k):void 0}}(this),w=function(){return v.css("opacity",.5),setTimeout(x,10)},w(),this.data("refresh",w),this.find(".pvtAxisContainer").sortable({update:function(a,b){return null==b.sender?w():void 0},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(W){p=W,"undefined"!=typeof console&&null!==console&&console.error(p.stack),this.html(u.localeStrings.uiRenderError)}return this}}.call(this),function(){var a;a=jQuery,a.pivotUtilities.d3_renderers={Treemap:{name:"Treemap",maxAggregators:1,render:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(f={localeStrings:{}},c=a.extend(f,c),i=a("<div style='width: 100%; height: 100%;'>"),k={name:"All",children:[]},d=function(a,b,c){var e,f,g,h,i,j;if(0===b.length)return void(a.value=c);for(null==a.children&&(a.children=[]),g=b.shift(),j=a.children,h=0,i=j.length;i>h;h++)if(e=j[h],e.name===g)return void d(e,b,c);return f={name:g},d(f,b,c),a.children.push(f)},q=b.getRowKeys(),o=0,p=q.length;p>o;o++)j=q[o],m=b.getAggregator(j,[]).value(),null!=m&&d(k,j,m[0]);return e=d3.scale.category10(),n=a(window).width()/1.4,g=a(window).height()/1.4,h=10,l=d3.layout.treemap().size([n,g]).sticky(!0).value(function(a){return a.size}),d3.select(i[0]).append("div").style("position","relative").style("width",n+2*h+"px").style("height",g+2*h+"px").style("left",h+"px").style("top",h+"px").datum(k).selectAll(".node").data(l.padding([15,0,0,0]).value(function(a){return a.value}).nodes).enter().append("div").attr("class","node").style("background",function(a){return null!=a.children?"lightgrey":e(a.name)}).text(function(a){return a.name}).call(function(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return Math.max(0,a.dx-1)+"px"}).style("height",function(a){return Math.max(0,a.dy-1)+"px"})}),i}}}}.call(this),function(){var a,b;a=jQuery,b=function(b,c){return{name:c.name,maxAggregators:c.maxAggregators,render:function(d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;for(k={localeStrings:{vs:"vs",by:"by"}},e=a.extend(k,e),v=d.getRowKeys(),0===v.length&&v.push([]),h=d.getColKeys(),0===h.length&&h.push([]),o=function(){var a,b,c;for(c=[],a=0,b=v.length;b>a;a++)m=v[a],c.push(m.join("-"));return c}(),o.unshift(""),q=0,i=[o],A=0,C=h.length;C>A;A++){for(g=h[A],t=[g.join("-")],q+=t[0].length,B=0,D=v.length;D>B;B++)u=v[B],f=d.getAggregator(u,g),t.push(null!=f.value()?f.value()[0]:null);i.push(t)}w=y=d.aggregatorName+(d.valAttrs.length?"("+d.valAttrs.join(", ")+")":""),n=d.colAttrs.join("-"),""!==n&&(w+=" "+e.localeStrings.vs+" "+n),l=d.rowAttrs.join("-"),""!==l&&(w+=" "+e.localeStrings.by+" "+l),r={width:a(window).width()/1.4,height:a(window).height()/1.4,title:w,hAxis:{title:n,slantedText:q>50},vAxis:{title:y}},2===i[0].length&&""===i[0][1]&&(r.legend={position:"none"});for(p in c)x=c[p],r[p]=x;return j=google.visualization.arrayToDataTable(i),s=a("<div style='width: 100%; height: 100%;'>"),z=new google.visualization.ChartWrapper({dataTable:j,chartType:b,options:r}),z.draw(s[0]),s.bind("dblclick",function(){var a;return a=new google.visualization.ChartEditor,google.visualization.events.addListener(a,"ok",function(){return a.getChartWrapper().draw(s[0])}),a.openDialog(z)}),s}}},a.pivotUtilities.gchart_renderers={"Line Chart":b("LineChart",{maxAggregators:1,name:"Line Chart"}),"Bar Chart":b("ColumnChart",{maxAggregators:1,name:"Bar Chart"}),"Stacked Bar Chart":b("ColumnChart",{isStacked:!0,maxAggregators:1,name:"Stacked Bar Chart"}),"Area Chart":b("AreaChart",{isStacked:!0,maxAggregators:1,name:"Area Chart"})}}.call(this),function(){var a,b,c={}.hasOwnProperty;a=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;i={localeStrings:{totals:"Totals"}},b=$.extend(i,b),f=a.colAttrs,n=a.rowAttrs,p=a.getRowKeys(),h=a.getColKeys(),m=document.createElement("table"),m.className="pvtTable",q=function(a,b,c){var d,e,f,g,h,i;if(0!==b){for(e=!0,g=h=0;c>=0?c>=h:h>=c;g=c>=0?++h:--h)a[b-1][g]!==a[b][g]&&(e=!1);if(e)return-1}for(d=0;b+d<a.length;){for(f=!1,g=i=0;c>=0?c>=i:i>=c;g=c>=0?++i:--i)a[b][g]!==a[b+d][g]&&(f=!0);if(f)break;d++}return d};for(k in f)if(c.call(f,k)){e=f[k],u=document.createElement("tr"),0===parseInt(k)&&0!==n.length&&(s=document.createElement("th"),s.setAttribute("colspan",n.length),s.setAttribute("rowspan",f.length),u.appendChild(s)),s=document.createElement("th"),s.className="pvtAxisLabel",s.textContent=e,u.appendChild(s);for(j in h)c.call(h,j)&&(g=h[j],x=q(h,parseInt(j),parseInt(k)),-1!==x&&(s=document.createElement("th"),s.className="pvtColLabel",s.textContent=g[k],s.setAttribute("colspan",x),parseInt(k)===f.length-1&&0!==n.length&&s.setAttribute("rowspan",2),u.appendChild(s)));0===parseInt(k)&&(s=document.createElement("th"),s.className="pvtTotalLabel",s.innerHTML=b.localeStrings.totals,s.setAttribute("rowspan",f.length+(0===n.length?0:1)),u.appendChild(s)),m.appendChild(u)}if(0!==n.length){u=document.createElement("tr");for(j in n)c.call(n,j)&&(l=n[j],s=document.createElement("th"),s.className="pvtAxisLabel",s.textContent=l,u.appendChild(s));s=document.createElement("th"),0===f.length&&(s.className="pvtTotalLabel",s.innerHTML=b.localeStrings.totals),u.appendChild(s),m.appendChild(u)}for(j in p)if(c.call(p,j)){o=p[j],u=document.createElement("tr");for(k in o)c.call(o,k)&&(v=o[k],x=q(p,parseInt(j),parseInt(k)),-1!==x&&(s=document.createElement("th"),s.className="pvtRowLabel",s.textContent=v,s.setAttribute("rowspan",x),parseInt(k)===n.length-1&&0!==f.length&&s.setAttribute("colspan",2),u.appendChild(s)));for(k in h)c.call(h,k)&&(g=h[k],d=a.getAggregator(o,g),w=d.value(),r=document.createElement("td"),r.className="pvtVal row"+j+" col"+k,r.innerHTML=d.format(w),r.setAttribute("data-value",w),u.appendChild(r));t=a.getAggregator(o,[]),w=t.value(),r=document.createElement("td"),r.className="pvtTotal rowTotal",r.innerHTML=t.format(w),r.setAttribute("data-value",w),r.setAttribute("data-for","row"+j),u.appendChild(r),m.appendChild(u)}u=document.createElement("tr"),s=document.createElement("th"),s.className="pvtTotalLabel",s.innerHTML=b.localeStrings.totals,s.setAttribute("colspan",n.length+(0===f.length?0:1)),u.appendChild(s);for(k in h)c.call(h,k)&&(g=h[k],t=a.getAggregator([],g),w=t.value(),r=document.createElement("td"),r.className="pvtTotal colTotal",r.innerHTML=t.format(w),r.setAttribute("data-value",w),r.setAttribute("data-for","col"+k),u.appendChild(r));return t=a.getAggregator([],[]),w=t.value(),r=document.createElement("td"),r.className="pvtGrandTotal",r.innerHTML=t.format(w),r.setAttribute("data-value",w),u.appendChild(r),m.appendChild(u),m.setAttribute("data-numrows",p.length),m.setAttribute("data-numcols",h.length),m},$.fn.heatmap=function(a){var b,c,d,e,f,g,h,i;switch(null==a&&(a="heatmap"),g=this.data("numrows"),f=this.data("numcols"),b=function(a,b,c){var d;return d=function(){switch(a){case"red":return function(a){return"ff"+a+a};case"green":return function(a){return""+a+"ff"+a};case"blue":return function(a){return""+a+a+"ff"}}}(),function(a){var e,f;return f=255-Math.round(255*(a-b)/(c-b)),e=f.toString(16).split(".")[0],1===e.length&&(e=0+e),d(e)}},c=function(a){return function(c,d){var e,f,g;return f=function(b){return a.find(c).each(function(){var a;return a=$(this).data("value"),null!=a&&isFinite(a)?b(a,$(this)):void 0})},g=[],f(function(a){return g.push(a)}),e=b(d,Math.min.apply(Math,g),Math.max.apply(Math,g)),f(function(a,b){return b.css("background-color","#"+e(a))})}}(this),a){case"heatmap":c(".pvtVal","red");break;case"rowheatmap":for(d=h=0;g>=0?g>h:h>g;d=g>=0?++h:--h)c(".pvtVal.row"+d,"red");break;case"colheatmap":for(e=i=0;f>=0?f>i:i>f;e=f>=0?++i:--i)c(".pvtVal.col"+e,"red")}return c(".pvtTotal.rowTotal","red"),c(".pvtTotal.colTotal","red"),this},$.fn.barchart=function(){var a,b,c,d,e;for(d=this.data("numrows"),c=this.data("numcols"),a=function(a){return function(b){var c,d,e,f;return c=function(c){return a.find(b).each(function(){var a;return a=$(this).data("value"),null!=a&&isFinite(a)?c(a,$(this)):void 0})},f=[],c(function(a){return f.push(a)}),d=Math.max.apply(Math,f),e=function(a){return 100*a/(1.4*d)},c(function(a,b){var c,d;return c=b.text(),d=$("<div>").css({position:"relative",height:"55px"}),d.append($("<div>").css({position:"absolute",bottom:0,left:0,right:0,height:e(a)+"%","background-color":"gray"})),d.append($("<div>").text(c).css({position:"relative","padding-left":"5px","padding-right":"5px"})),b.css({padding:0,"padding-top":"5px","text-align":"center"}).html(d)})}}(this),b=e=0;d>=0?d>e:e>d;b=d>=0?++e:--e)a(".pvtVal.row"+b);return a(".pvtTotal.colTotal"),this},b={Table:{name:"Table",render:function(b,c){return a(b,c)}},"Table Barchart":{name:"Table Barchart",render:function(b,c){return $(a(b,c)).barchart()}},Heatmap:{name:"Table Heatmap",render:function(b,c){return $(a(b,c)).heatmap()}},"Row Heatmap":{name:"Table Row Heatmap",render:function(b,c){return $(a(b,c)).heatmap("rowheatmap")}},"Col Heatmap":{name:"Table Col Heatmap",render:function(b,c){return $(a(b,c)).heatmap("colheatmap")}}},$.extend($.pivotUtilities.renderers,b)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{name:"Average",sum:0,len:0,push:function(a){return isNaN(parseFloat(a[c]))?void 0:(this.sum+=parseFloat(a[c]),this.len++)},value:function(){return this.sum/this.len},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Average:a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Average=a)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{name:"Count",count:0,push:function(){return this.count++},value:function(){return this.count},format:a||$.pivotUtilities.formatterTemplates["default"]}}}},b={Count:a($.pivotUtilities.numberFormat({digitsAfterDecimal:0}))},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Count=a)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{name:"Max",largest:null,push:function(a){return!isNaN(parseFloat(a[c]))&&(parseFloat(a[c])>this.largest||null===this.largest)?this.largest=parseFloat(a[c]):void 0},value:function(){return this.largest},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Max:a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Max=a)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{name:"Min",smallest:null,push:function(a){return!isNaN(parseFloat(a[c]))&&(parseFloat(a[c])<this.smallest||null===this.smallest)?this.smallest=parseFloat(a[c]):void 0},value:function(){return this.smallest},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Min:a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Min=a)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{name:"Sum",sum:0,push:function(a){return isNaN(parseFloat(a[c]))?void 0:this.sum+=parseFloat(a[c])},value:function(){return this.sum},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Sum:a($.pivotUtilities.numberFormat()),"Integer Sum":a($.pivotUtilities.numberFormat({digitsAfterDecimal:0}))},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Sum=a)}.call(this),function(){var a;a={"Count as Fraction of Total":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Count(),"Count as Fraction of Total","total"),"Count as Fraction of Rows":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Count(),"Count as Fraction of Rows","row"),"Count as Fraction of Columns":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Count(),"Count as Fraction of Columns","col")},$.extend($.pivotUtilities.aggregators,a)}.call(this),function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a){return function(b){var d;return d=b[0],function(){return{name:"Count Unique",uniq:[],push:function(a){var b;return b=a[d],c.call(this.uniq,b)<0?this.uniq.push(a[d]):void 0},value:function(){return this.uniq.length},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={"Count Unique":a($.pivotUtilities.numberFormat({digitsAfterDecimal:0}))},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a){return function(b){var d;return d=b[0],function(){return{name:"List Unique",uniq:[],push:function(a){var b;return b=a[d],c.call(this.uniq,b)<0?this.uniq.push(a[d]):void 0},value:function(){return this.uniq.join(", ")},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={"List Unique":a()},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(b,d,e){return{name:"Standard Deviation",avg:$.pivotUtilities.aggregatorTemplates.Average($.pivotUtilities.numberFormat())([c])(b,d,e),values:[],variance:0,push:function(a){return this.avg.push(a),isNaN(parseFloat(a[c]))?void 0:this.values.push(parseFloat(a[c]))},value:function(){var a,b,c,d,e;for(a=0,e=this.values,c=0,d=e.length;d>c;c++)b=e[c],a+=Math.pow(b-this.avg.value(),2);return this.variance=a/this.values.length,Math.sqrt(this.variance)},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={"Standard Deviation":a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.StdDev=a)}.call(this),function(){var a;a={"Sum as Fraction of Total":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Sum(),"Sum as Fraction of Total","total"),"Sum as Fraction of Rows":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Sum(),"Sum as Fraction of Rows","row"),"Sum as Fraction of Columns":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Sum(),"Sum as Fraction of Columns","col")},$.extend($.pivotUtilities.aggregators,a)}.call(this),function(){var a,b;a=function(a,b,c){return null==c&&(c=!0),function(d){var e,f;return f=d[0],e=d[1],function(){return{name:a,sumNum:0,sumDenom:0,push:function(a){return isNaN(parseFloat(a[f]))||(this.sumNum+=parseFloat(a[f])),isNaN(parseFloat(a[e]))?void 0:this.sumDenom+=parseFloat(a[e])},value:function(){var a;return a=c?1:-1,(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*a*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:b||$.pivotUtilities.formatterTemplates["default"],numInputs:2}}}},b={"80% Upper Bound":a("80% Upper Bound",$.pivotUtilities.numberFormat()),"80% Lower Bound":a("80% Lower Bound",$.pivotUtilities.numberFormat(),!1)},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b;a=function(a){return function(b){var c,d;return d=b[0],c=b[1],function(){return{name:"Sum over Sum",sumNum:0,sumDenom:0,push:function(a){return isNaN(parseFloat(a[d]))||(this.sumNum+=parseFloat(a[d])),isNaN(parseFloat(a[c]))?void 0:this.sumDenom+=parseFloat(a[c])},value:function(){return this.sumNum/this.sumDenom},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:2}}}},b={"Sum over Sum":a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b)}.call(this);