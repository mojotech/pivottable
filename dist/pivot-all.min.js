(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=[].slice,p=function(a,b){return function(){return a.apply(b,arguments)}},q={}.hasOwnProperty,r=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=jQuery,c=function(a,b,c){var d,e,f,g;for(a+="",e=a.split("."),f=e[0],g=e.length>1?c+e[1]:"",d=/(\d+)(\d{3})/;d.test(f);)f=f.replace(d,"$1"+b+"$2");return f+g},l=function(b){var d;return d={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:!1},b=a.extend(d,b),function(a){var d;return isNaN(a)||!isFinite(a)?"":0!==a||b.showZero?(d=c((b.scaler*a).toFixed(b.digitsAfterDecimal),b.thousandsSep,b.decimalSep),""+b.prefix+d+b.suffix):""}},h={"default":function(a){return a},percentFormat:l({digitsAfterDecimal:1,scaler:100,suffix:"%"})},d={fractionOf:function(a,b,c){return null==b&&(b="total"),null==c&&(c=h.percentFormat),function(){var d;return d=1<=arguments.length?o.call(arguments,0):[],function(e,f,g){return{selector:{total:[[],[]],row:[f,[]],col:[[],g]}[b],inner:a.apply(null,d)(e,f,g),push:function(a){return this.inner.push(a)},format:c,value:function(){return this.inner.value()/e.getAggregator.apply(e,this.selector).inner.value()},numInputs:a.apply(null,d)().numInputs}}}}},e={},m={},i={en:{aggregators:e,renderers:m,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter results",totals:"Totals",vs:"vs",by:"by"}}},j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=function(a){return("0"+a).substr(-2,2)},g={bin:function(a,b){return function(c){return c[a]-c[a]%b}},dateFormat:function(a,b,c,d){return null==c&&(c=j),null==d&&(d=f),function(e){var f;return f=new Date(Date.parse(e[a])),isNaN(f)?"":b.replace(/%(.)/g,function(a,b){switch(b){case"y":return f.getFullYear();case"m":return n(f.getMonth()+1);case"n":return c[f.getMonth()];case"d":return n(f.getDate());case"w":return d[f.getDay()];case"x":return f.getDay();case"H":return n(f.getHours());case"M":return n(f.getMinutes());case"S":return n(f.getSeconds());default:return"%"+b}})}}},k=function(){return function(a,b){var c,d,e,f,g,h,i;if(h=/(\d+)|(\D+)/g,g=/\d/,i=/^0/,"number"==typeof a||"number"==typeof b)return isNaN(a)?1:isNaN(b)?-1:a-b;if(c=String(a).toLowerCase(),e=String(b).toLowerCase(),c===e)return 0;if(!g.test(c)||!g.test(e))return c>e?1:-1;for(c=c.match(h),e=e.match(h);c.length&&e.length;)if(d=c.shift(),f=e.shift(),d!==f)return g.test(d)&&g.test(f)?d.replace(i,".0")-f.replace(i,".0"):d>f?1:-1;return c.length-e.length}}(this),a.pivotUtilities={aggregatorTemplates:d,aggregators:e,renderers:m,derivers:g,locales:i,naturalSort:k,numberFormat:l,formatterTemplates:h},b=function(){function b(a,c){this.getAggregator=p(this.getAggregator,this),this.getRowKeys=p(this.getRowKeys,this),this.getColKeys=p(this.getColKeys,this),this.sortKeys=p(this.sortKeys,this),this.arrSort=p(this.arrSort,this),this.natSort=p(this.natSort,this),this.aggregator=c.aggregator,this.aggregatorName=c.aggregatorName,this.colAttrs=c.cols,this.rowAttrs=c.rows,this.valAttrs=c.vals,this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,b.forEachRecord(a,c.derivedAttributes,function(a){return function(b){return c.filter(b)?a.processRecord(b):void 0}}(this))}return b.forEachRecord=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(e=a.isEmptyObject(c)?d:function(a){var b,e,f;for(b in c)e=c[b],a[b]=null!=(f=e(a))?f:a[b];return d(a)},a.isFunction(b))return b(e);if(a.isArray(b)){if(a.isArray(b[0])){o=[];for(g in b)if(q.call(b,g)&&(f=b[g],g>0)){j={},n=b[0];for(h in n)q.call(n,h)&&(i=n[h],j[i]=f[h]);o.push(e(j))}return o}for(p=[],l=0,m=b.length;m>l;l++)j=b[l],p.push(e(j));return p}if(b instanceof jQuery)return k=[],a("thead > tr > th",b).each(function(){return k.push(a(this).text())}),a("tbody > tr",b).each(function(){return j={},a("td",this).each(function(b){return j[k[b]]=a(this).text()}),e(j)});throw new Error("unknown input format")},b.convertToArray=function(a){var c;return c=[],b.forEachRecord(a,{},function(a){return c.push(a)}),c},b.prototype.natSort=function(a,b){return k(a,b)},b.prototype.arrSort=function(a,b){return this.natSort(a.join(),b.join())},b.prototype.sortKeys=function(){return this.sorted||(this.rowKeys.sort(this.arrSort),this.colKeys.sort(this.arrSort)),this.sorted=!0},b.prototype.getColKeys=function(){return this.sortKeys(),this.colKeys},b.prototype.getRowKeys=function(){return this.sortKeys(),this.rowKeys},b.prototype.processRecord=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(b=[],e=[],k=this.colAttrs,g=0,i=k.length;i>g;g++)f=k[g],b.push(null!=(l=a[f])?l:"null");for(m=this.rowAttrs,h=0,j=m.length;j>h;h++)f=m[h],e.push(null!=(n=a[f])?n:"null");return d=e.join(String.fromCharCode(0)),c=b.join(String.fromCharCode(0)),this.allTotal.push(a),0!==e.length&&(this.rowTotals[d]||(this.rowKeys.push(e),this.rowTotals[d]=this.aggregator(this,e,[])),this.rowTotals[d].push(a)),0!==b.length&&(this.colTotals[c]||(this.colKeys.push(b),this.colTotals[c]=this.aggregator(this,[],b)),this.colTotals[c].push(a)),0!==b.length&&0!==e.length?(this.tree[d]||(this.tree[d]={}),this.tree[d][c]||(this.tree[d][c]=this.aggregator(this,e,b)),this.tree[d][c].push(a)):void 0},b.prototype.getAggregator=function(a,b){var c,d,e;return e=a.join(String.fromCharCode(0)),d=b.join(String.fromCharCode(0)),c=0===a.length&&0===b.length?this.allTotal:0===a.length?this.colTotals[d]:0===b.length?this.rowTotals[e]:this.tree[e][d],null!=c?c:{value:function(){return null},format:function(){return""}}},b}(),a.fn.pivot=function(c,d){var e,f,g,h,j;e={cols:[],rows:[],filter:function(){return!0},aggregator:"",aggregatorName:"",derivedAttributes:{},renderer:"",rendererOptions:null,localeStrings:i.en.localeStrings},d=a.extend(e,d),h=null;try{g=new b(c,d);try{h=d.renderer(g,d.rendererOptions)}catch(k){f=k,"undefined"!=typeof console&&null!==console&&console.error(f.stack),h=a("<span>").html(d.localeStrings.renderError)}}catch(k){f=k,"undefined"!=typeof console&&null!==console&&console.error(f.stack),h=a("<span>").html(d.localeStrings.computeError)}for(j=this[0];j.hasChildNodes();)j.removeChild(j.lastChild);return this.append(h)},a.fn.pivotUI=function(c,d,e,f){var g,h,j,l,m,n,o,p,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;null==e&&(e=!1),null==f&&(f="en"),p={derivedAttributes:{},aggregators:i[f].aggregators,renderers:i[f].renderers,attributes:[],values:[],hiddenAttributes:[],menuLimit:200,cols:[],rows:[],vals:[],exclusions:{},unusedAttrsVertical:"auto",autoSortUnusedAttrs:!1,rendererOptions:{localeStrings:i[f].localeStrings},onRefresh:null,filter:function(){return!0},localeStrings:i[f].localeStrings},t=this.data("pivotUIOptions"),x=null==t||e?a.extend(p,d):t;try{c=b.convertToArray(c),F=function(){var a,b;a=c[0],b=[];for(w in a)q.call(a,w)&&b.push(w);return b}(),U=x.derivedAttributes;for(m in U)q.call(U,m)&&r.call(F,m)<0&&F.push(m);for(l={},M=0,Q=F.length;Q>M;M++)K=F[M],l[K]={};b.forEachRecord(c,x.derivedAttributes,function(a){var b,c,d;d=[];for(w in a)q.call(a,w)&&(b=a[w],x.filter(a)&&(null==b&&(b="null"),null==(c=l[w])[b]&&(c[b]=0),d.push(l[w][b]++)));return d}),I=a("<table cellpadding='5'>"),C=a("<td>"),B=a("<select class='pvtRenderer'>").appendTo(C).bind("change",function(){return z()}),V=x.renderers;for(K in V)q.call(V,K)&&a("<option>").val(K).html(K).appendTo(B);if(n=a("<td class='pvtAxisContainer pvtUnused'>"),D=x.attributes.length>0?function(){var a,b,c;for(c=[],a=0,b=F.length;b>a;a++)m=F[a],r.call(x.attributes,m)>=0&&c.push(m);return c}():function(){var a,b,c;for(c=[],a=0,b=F.length;b>a;a++)m=F[a],r.call(x.hiddenAttributes,m)<0&&r.call(x.values,m)<0&&c.push(m);return c}(),E=x.values.length>0?function(){var a,b,c;for(c=[],a=0,b=F.length;b>a;a++)o=F[a],r.call(x.values,o)>=0&&c.push(o);return c}():D,J=!1,"auto"===x.unusedAttrsVertical){for(j=0,N=0,R=D.length;R>N;N++)g=D[N],j+=g.length;J=j>120}n.addClass(x.unusedAttrsVertical===!0||J?"pvtVertList":"pvtHorizList"),L=function(b){var c,d,e,f,g,h,i,j,m,o,p,q,s,t,v;if(i=function(){var a;a=[];for(w in l[b])a.push(w);return a}(),h=!1,q=a("<div>").addClass("pvtFilterBox").hide(),q.append(a("<h4>").text(""+b+" ("+i.length+")")),i.length>x.menuLimit)q.append(a("<p>").html(x.localeStrings.tooMany));else for(d=a("<p>").appendTo(q),d.append(a("<button>").html(x.localeStrings.selectAll).bind("click",function(){return q.find("input").prop("checked",!0)})),d.append(a("<button>").html(x.localeStrings.selectNone).bind("click",function(){return q.find("input").prop("checked",!1)})),d.append(a("<input>").addClass("pvtSearch").attr("placeholder",x.localeStrings.filterResults).bind("keyup",function(){var b;return b=a(this).val().toLowerCase(),a(this).parents(".pvtFilterBox").find("label span").each(function(){var c;return c=this.innerText.toLowerCase().indexOf(b),-1!==c?a(this).parent().show():a(this).parent().hide()})})),e=a("<div>").addClass("pvtCheckContainer").appendTo(q),v=i.sort(k),s=0,t=v.length;t>s;s++)w=v[s],p=l[b][w],f=a("<label>"),g=x.exclusions[b]?r.call(x.exclusions[b],w)>=0:!1,h||(h=g),a("<input type='checkbox' class='pvtFilter'>").attr("checked",!g).data("filter",[b,w]).appendTo(f),f.append(a("<span>").text(""+w+" ("+p+")")),e.append(a("<p>").append(f));return o=function(){var b;return b=a(q).find("[type='checkbox']").length-a(q).find("[type='checkbox']:checked").length,b>0?c.addClass("pvtFilteredAttribute"):c.removeClass("pvtFilteredAttribute"),i.length>x.menuLimit?q.toggle():q.toggle(0,z)},a("<p>").appendTo(q).append(a("<button>").text("OK").bind("click",o)),j=function(b){return q.css({left:b.pageX,top:b.pageY}).toggle(),a(".pvtSearch").val(""),a("label").show()},m=a("<span class='pvtTriangle'>").html(" &#x25BE;").bind("click",j),c=a("<li class='axis_"+u+"'>").append(a("<span class='pvtAttr'>").text(b).data("attrName",b).append(m)),h&&c.addClass("pvtFilteredAttribute"),n.append(c).append(q),c.bind("dblclick",j)};for(u in D)m=D[u],L(m);G=a("<tr>").appendTo(I),h=a("<select class='pvtAggregator'>").bind("change",function(){return z()}),W=x.aggregators;for(K in W)q.call(W,K)&&h.append(a("<option>").val(K).html(K));for(a("<td class='pvtVals'>").appendTo(G).append(h).append(a("<br>")),a("<td class='pvtAxisContainer pvtHorizList pvtCols'>").appendTo(G),H=a("<tr>").appendTo(I),H.append(a("<td valign='top' class='pvtAxisContainer pvtRows'>")),y=a("<td valign='top' class='pvtRendererArea'>").appendTo(H),x.unusedAttrsVertical===!0||J?(I.find("tr:nth-child(1)").prepend(C),I.find("tr:nth-child(2)").prepend(n)):I.prepend(a("<tr>").append(C).append(n)),this.html(I),X=x.cols,O=0,S=X.length;S>O;O++)K=X[O],this.find(".pvtCols").append(this.find(".axis_"+D.indexOf(K)));for(Y=x.rows,P=0,T=Y.length;T>P;P++)K=Y[P],this.find(".pvtRows").append(this.find(".axis_"+D.indexOf(K)));null!=x.aggregatorName&&this.find(".pvtAggregator").val(x.aggregatorName),null!=x.rendererName&&this.find(".pvtRenderer").val(x.rendererName),v=!0,A=function(b){return function(){var d,e,f,g,i,j,k,l,m,n,o,p,q,s;if(l={derivedAttributes:x.derivedAttributes,localeStrings:x.localeStrings,rendererOptions:x.rendererOptions,cols:[],rows:[]},i=null!=(s=x.aggregators[h.val()]([])().numInputs)?s:0,n=[],b.find(".pvtRows li span.pvtAttr").each(function(){return l.rows.push(a(this).data("attrName"))}),b.find(".pvtCols li span.pvtAttr").each(function(){return l.cols.push(a(this).data("attrName"))}),b.find(".pvtVals select.pvtAttrDropdown").each(function(){return 0===i?a(this).remove():(i--,""!==a(this).val()?n.push(a(this).val()):void 0)}),0!==i)for(k=b.find(".pvtVals"),K=p=0;i>=0?i>p:p>i;K=i>=0?++p:--p){for(g=a("<select class='pvtAttrDropdown'>").append(a("<option>")).bind("change",function(){return z()}),q=0,o=E.length;o>q;q++)d=E[q],g.append(a("<option>").val(d).text(d));k.append(g)}return v&&(n=x.vals,u=0,b.find(".pvtVals select.pvtAttrDropdown").each(function(){return a(this).val(n[u]),u++}),v=!1),l.aggregatorName=h.val(),l.vals=n,l.aggregator=x.aggregators[h.val()](n),l.renderer=x.renderers[B.val()],e={},b.find("input.pvtFilter").not(":checked").each(function(){var b;return b=a(this).data("filter"),null!=e[b[0]]?e[b[0]].push(b[1]):e[b[0]]=[b[1]]}),l.filter=function(a){var b,c;if(!x.filter(a))return!1;for(w in e)if(b=e[w],c=""+a[w],r.call(b,c)>=0)return!1;return!0},y.pivot(c,l),j=a.extend(x,{cols:l.cols,rows:l.rows,vals:n,exclusions:e,aggregatorName:h.val(),rendererName:B.val()}),b.data("pivotUIOptions",j),x.autoSortUnusedAttrs&&(f=a.pivotUtilities.naturalSort,m=b.find("td.pvtUnused.pvtAxisContainer"),a(m).children("li").sort(function(b,c){return f(a(b).text(),a(c).text())}).appendTo(m)),y.css("opacity",1),null!=x.onRefresh?x.onRefresh(j):void 0}}(this),z=function(){return function(){return y.css("opacity",.5),setTimeout(A,10)}}(this),z(),this.data("refresh",z),this.find(".pvtAxisContainer").sortable({update:function(a,b){return null==b.sender?z():void 0},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(Z){s=Z,"undefined"!=typeof console&&null!==console&&console.error(s.stack),this.html(x.localeStrings.uiRenderError)}return this}}).call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{sum:0,len:0,push:function(a){return isNaN(parseFloat(a[c]))?void 0:(this.sum+=parseFloat(a[c]),this.len++)},value:function(){return this.sum/this.len},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Average:a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Average=a)}.call(this),function(){var a;a={"Count as Fraction of Total":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Count(),"total"),"Count as Fraction of Rows":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Count(),"row"),"Count as Fraction of Columns":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Count(),"col")},$.extend($.pivotUtilities.aggregators,a)}.call(this),function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a){return function(b){var d;return d=b[0],function(){return{uniq:[],push:function(a){var b;return b=a[d],c.call(this.uniq,b)<0?this.uniq.push(a[d]):void 0},value:function(){return this.uniq.length},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={"Count Unique":a($.pivotUtilities.numberFormat({digitsAfterDecimal:0}))},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:a||$.pivotUtilities.formatterTemplates["default"]}}}},b={Count:a($.pivotUtilities.numberFormat({digitsAfterDecimal:0}))},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Count=a)}.call(this),function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a){return function(b){var d;return d=b[0],function(){return{uniq:[],push:function(a){var b;return b=a[d],c.call(this.uniq,b)<0?this.uniq.push(a[d]):void 0},value:function(){return this.uniq.join(", ")},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={"List Unique":a()},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{largest:null,push:function(a){return!isNaN(parseFloat(a[c]))&&(parseFloat(a[c])>this.largest||null===this.largest)?this.largest=parseFloat(a[c]):void 0},value:function(){return this.largest},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Max:a()},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Max=a)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{smallest:null,push:function(a){return!isNaN(parseFloat(a[c]))&&(parseFloat(a[c])<this.smallest||null===this.smallest)?this.smallest=parseFloat(a[c]):void 0},value:function(){return this.smallest},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Min:a()},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Min=a)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(b,d,e){return{avg:$.pivotUtilities.aggregatorTemplates.Average($.pivotUtilities.numberFormat())([c])(b,d,e),values:[],variance:0,push:function(a){return this.avg.push(a),isNaN(parseFloat(a[c]))?void 0:this.values.push(parseFloat(a[c]))},value:function(){var a,b,c,d,e;for(a=0,e=this.values,c=0,d=e.length;d>c;c++)b=e[c],a+=Math.pow(b-this.avg.value(),2);return this.variance=a/this.values.length,Math.sqrt(this.variance)},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={"Standard Deviation":a()},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.StdDev=a)}.call(this),function(){var a;a={"Sum as Fraction of Total":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Sum(),"total"),"Sum as Fraction of Rows":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Sum(),"row"),"Sum as Fraction of Columns":$.pivotUtilities.aggregatorTemplates.fractionOf($.pivotUtilities.aggregatorTemplates.Sum(),"col")},$.extend($.pivotUtilities.aggregators,a)}.call(this),function(){var a,b;a=function(a,b){return null==b&&(b=!0),function(c){var d,e;return e=c[0],d=c[1],function(){return{sumNum:0,sumDenom:0,push:function(a){return isNaN(parseFloat(a[e]))||(this.sumNum+=parseFloat(a[e])),isNaN(parseFloat(a[d]))?void 0:this.sumDenom+=parseFloat(a[d])},value:function(){var a;return a=b?1:-1,(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*a*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:2}}}},b={"80% Upper Bound":a($.pivotUtilities.numberFormat()),"80% Lower Bound":a($.pivotUtilities.numberFormat(),!1)},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b;a=function(a){return function(b){var c,d;return d=b[0],c=b[1],function(){return{sumNum:0,sumDenom:0,push:function(a){return isNaN(parseFloat(a[d]))||(this.sumNum+=parseFloat(a[d])),isNaN(parseFloat(a[c]))?void 0:this.sumDenom+=parseFloat(a[c])},value:function(){return this.sumNum/this.sumDenom},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:2}}}},b={"Sum over Sum":a($.pivotUtilities.numberFormat())},$.extend($.pivotUtilities.aggregators,b)}.call(this),function(){var a,b,c;a=function(a){return function(b){var c;return c=b[0],function(){return{sum:0,push:function(a){return isNaN(parseFloat(a[c]))?void 0:this.sum+=parseFloat(a[c])},value:function(){return this.sum},format:a||$.pivotUtilities.formatterTemplates["default"],numInputs:1}}}},b={Sum:a($.pivotUtilities.numberFormat()),"Integer Sum":a($.pivotUtilities.numberFormat({digitsAfterDecimal:0}))},$.extend($.pivotUtilities.aggregators,b),null!=(c=$.pivotUtilities.aggregatorTemplates)&&(c.Sum=a)}.call(this),function(){var a;a=jQuery,a.pivotUtilities.d3_renderers={Treemap:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(f={localeStrings:{}},c=a.extend(f,c),i=a("<div style='width: 100%; height: 100%;'>"),k={name:"All",children:[]},d=function(a,b,c){var e,f,g,h,i,j;if(0===b.length)return void(a.value=c);for(null==a.children&&(a.children=[]),g=b.shift(),j=a.children,h=0,i=j.length;i>h;h++)if(e=j[h],e.name===g)return void d(e,b,c);return f={name:g},d(f,b,c),a.children.push(f)},q=b.getRowKeys(),o=0,p=q.length;p>o;o++)j=q[o],m=b.getAggregator(j,[]).value(),null!=m&&d(k,j,m);return e=d3.scale.category10(),n=a(window).width()/1.4,g=a(window).height()/1.4,h=10,l=d3.layout.treemap().size([n,g]).sticky(!0).value(function(a){return a.size}),d3.select(i[0]).append("div").style("position","relative").style("width",n+2*h+"px").style("height",g+2*h+"px").style("left",h+"px").style("top",h+"px").datum(k).selectAll(".node").data(l.padding([15,0,0,0]).value(function(a){return a.value}).nodes).enter().append("div").attr("class","node").style("background",function(a){return null!=a.children?"lightgrey":e(a.name)}).text(function(a){return a.name}).call(function(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return Math.max(0,a.dx-1)+"px"}).style("height",function(a){return Math.max(0,a.dy-1)+"px"})}),i}}}.call(this),function(){var a,b;a=jQuery,b=function(b,c){return function(d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;for(k={localeStrings:{vs:"vs",by:"by"}},e=a.extend(k,e),v=d.getRowKeys(),0===v.length&&v.push([]),h=d.getColKeys(),0===h.length&&h.push([]),o=function(){var a,b,c;for(c=[],a=0,b=v.length;b>a;a++)m=v[a],c.push(m.join("-"));return c}(),o.unshift(""),q=0,i=[o],A=0,C=h.length;C>A;A++){for(g=h[A],t=[g.join("-")],q+=t[0].length,B=0,D=v.length;D>B;B++)u=v[B],f=d.getAggregator(u,g),t.push(null!=f.value()?f.value():null);i.push(t)}w=y=d.aggregatorName+(d.valAttrs.length?"("+d.valAttrs.join(", ")+")":""),n=d.colAttrs.join("-"),""!==n&&(w+=" "+e.localeStrings.vs+" "+n),l=d.rowAttrs.join("-"),""!==l&&(w+=" "+e.localeStrings.by+" "+l),r={width:a(window).width()/1.4,height:a(window).height()/1.4,title:w,hAxis:{title:n,slantedText:q>50},vAxis:{title:y}},2===i[0].length&&""===i[0][1]&&(r.legend={position:"none"});for(p in c)x=c[p],r[p]=x;return j=google.visualization.arrayToDataTable(i),s=a("<div style='width: 100%; height: 100%;'>"),z=new google.visualization.ChartWrapper({dataTable:j,chartType:b,options:r}),z.draw(s[0]),s.bind("dblclick",function(){var a;return a=new google.visualization.ChartEditor,google.visualization.events.addListener(a,"ok",function(){return a.getChartWrapper().draw(s[0])}),a.openDialog(z)}),s}},a.pivotUtilities.gchart_renderers={"Line Chart":b("LineChart"),"Bar Chart":b("ColumnChart"),"Stacked Bar Chart":b("ColumnChart",{isStacked:!0}),"Area Chart":b("AreaChart",{isStacked:!0})}}.call(this),function(){var a,b,c={}.hasOwnProperty;a=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;i={localeStrings:{totals:"Totals"}},b=$.extend(i,b),f=a.colAttrs,n=a.rowAttrs,p=a.getRowKeys(),h=a.getColKeys(),m=document.createElement("table"),m.className="pvtTable",q=function(a,b,c){var d,e,f,g,h,i;if(0!==b){for(e=!0,g=h=0;c>=0?c>=h:h>=c;g=c>=0?++h:--h)a[b-1][g]!==a[b][g]&&(e=!1);if(e)return-1}for(d=0;b+d<a.length;){for(f=!1,g=i=0;c>=0?c>=i:i>=c;g=c>=0?++i:--i)a[b][g]!==a[b+d][g]&&(f=!0);if(f)break;d++}return d};for(k in f)if(c.call(f,k)){e=f[k],u=document.createElement("tr"),0===parseInt(k)&&0!==n.length&&(s=document.createElement("th"),s.setAttribute("colspan",n.length),s.setAttribute("rowspan",f.length),u.appendChild(s)),s=document.createElement("th"),s.className="pvtAxisLabel",s.textContent=e,u.appendChild(s);for(j in h)c.call(h,j)&&(g=h[j],x=q(h,parseInt(j),parseInt(k)),-1!==x&&(s=document.createElement("th"),s.className="pvtColLabel",s.textContent=g[k],s.setAttribute("colspan",x),parseInt(k)===f.length-1&&0!==n.length&&s.setAttribute("rowspan",2),u.appendChild(s)));0===parseInt(k)&&(s=document.createElement("th"),s.className="pvtTotalLabel",s.innerHTML=b.localeStrings.totals,s.setAttribute("rowspan",f.length+(0===n.length?0:1)),u.appendChild(s)),m.appendChild(u)}if(0!==n.length){u=document.createElement("tr");for(j in n)c.call(n,j)&&(l=n[j],s=document.createElement("th"),s.className="pvtAxisLabel",s.textContent=l,u.appendChild(s));s=document.createElement("th"),0===f.length&&(s.className="pvtTotalLabel",s.innerHTML=b.localeStrings.totals),u.appendChild(s),m.appendChild(u)}for(j in p)if(c.call(p,j)){o=p[j],u=document.createElement("tr");for(k in o)c.call(o,k)&&(v=o[k],x=q(p,parseInt(j),parseInt(k)),-1!==x&&(s=document.createElement("th"),s.className="pvtRowLabel",s.textContent=v,s.setAttribute("rowspan",x),parseInt(k)===n.length-1&&0!==f.length&&s.setAttribute("colspan",2),u.appendChild(s)));for(k in h)c.call(h,k)&&(g=h[k],d=a.getAggregator(o,g),w=d.value(),r=document.createElement("td"),r.className="pvtVal row"+j+" col"+k,r.innerHTML=d.format(w),r.setAttribute("data-value",w),u.appendChild(r));t=a.getAggregator(o,[]),w=t.value(),r=document.createElement("td"),r.className="pvtTotal rowTotal",r.innerHTML=t.format(w),r.setAttribute("data-value",w),r.setAttribute("data-for","row"+j),u.appendChild(r),m.appendChild(u)}u=document.createElement("tr"),s=document.createElement("th"),s.className="pvtTotalLabel",s.innerHTML=b.localeStrings.totals,s.setAttribute("colspan",n.length+(0===f.length?0:1)),u.appendChild(s);for(k in h)c.call(h,k)&&(g=h[k],t=a.getAggregator([],g),w=t.value(),r=document.createElement("td"),r.className="pvtTotal colTotal",r.innerHTML=t.format(w),r.setAttribute("data-value",w),r.setAttribute("data-for","col"+k),u.appendChild(r));return t=a.getAggregator([],[]),w=t.value(),r=document.createElement("td"),r.className="pvtGrandTotal",r.innerHTML=t.format(w),r.setAttribute("data-value",w),u.appendChild(r),m.appendChild(u),m.setAttribute("data-numrows",p.length),m.setAttribute("data-numcols",h.length),m},$.fn.heatmap=function(a){var b,c,d,e,f,g,h,i;switch(null==a&&(a="heatmap"),g=this.data("numrows"),f=this.data("numcols"),b=function(a,b,c){var d;return d=function(){switch(a){case"red":return function(a){return"ff"+a+a};case"green":return function(a){return""+a+"ff"+a};case"blue":return function(a){return""+a+a+"ff"}}}(),function(a){var e,f;return f=255-Math.round(255*(a-b)/(c-b)),e=f.toString(16).split(".")[0],1===e.length&&(e=0+e),d(e)}},c=function(a){return function(c,d){var e,f,g;return f=function(b){return a.find(c).each(function(){var a;return a=$(this).data("value"),null!=a&&isFinite(a)?b(a,$(this)):void 0})},g=[],f(function(a){return g.push(a)}),e=b(d,Math.min.apply(Math,g),Math.max.apply(Math,g)),f(function(a,b){return b.css("background-color","#"+e(a))})}}(this),a){case"heatmap":c(".pvtVal","red");break;case"rowheatmap":for(d=h=0;g>=0?g>h:h>g;d=g>=0?++h:--h)c(".pvtVal.row"+d,"red");break;case"colheatmap":for(e=i=0;f>=0?f>i:i>f;e=f>=0?++i:--i)c(".pvtVal.col"+e,"red")}return c(".pvtTotal.rowTotal","red"),c(".pvtTotal.colTotal","red"),this},$.fn.barchart=function(){var a,b,c,d,e;for(d=this.data("numrows"),c=this.data("numcols"),a=function(a){return function(b){var c,d,e,f;return c=function(c){return a.find(b).each(function(){var a;return a=$(this).data("value"),null!=a&&isFinite(a)?c(a,$(this)):void 0})},f=[],c(function(a){return f.push(a)}),d=Math.max.apply(Math,f),e=function(a){return 100*a/(1.4*d)},c(function(a,b){var c,d;return c=b.text(),d=$("<div>").css({position:"relative",height:"55px"}),d.append($("<div>").css({position:"absolute",bottom:0,left:0,right:0,height:e(a)+"%","background-color":"gray"})),d.append($("<div>").text(c).css({position:"relative","padding-left":"5px","padding-right":"5px"})),b.css({padding:0,"padding-top":"5px","text-align":"center"}).html(d)})}}(this),b=e=0;d>=0?d>e:e>d;b=d>=0?++e:--e)a(".pvtVal.row"+b);return a(".pvtTotal.colTotal"),this},b={Table:function(b,c){return a(b,c)},"Table Barchart":function(b,c){return $(a(b,c)).barchart()},Heatmap:function(b,c){return $(a(b,c)).heatmap()},"Row Heatmap":function(b,c){return $(a(b,c)).heatmap("rowheatmap")},"Col Heatmap":function(b,c){return $(a(b,c)).heatmap("colheatmap")}},$.extend($.pivotUtilities.renderers,b)}.call(this);